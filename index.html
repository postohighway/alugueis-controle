
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Controle de Aluguéis – RF</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: -apple-system, BlinkMacSystemFont, Arial; background:#f2f2f7; margin:0; padding:12px; }
h1 { text-align:center; }

.card {
  border-radius:12px;
  padding:12px;
  margin-bottom:12px;
}
.paid { background:#dbeafe; }
.unpaid { background:#fee2e2; }

label { font-size:13px; display:block; margin-top:6px; }
input { width:100%; padding:6px; border-radius:6px; border:1px solid #ccc; }

button { margin-top:8px; padding:8px; border:none; border-radius:8px; background:#007aff; color:#fff; font-weight:bold; }

.status { font-weight:bold; margin-top:6px; }
</style>
</head>
<body>

<h1>Aluguéis + Energia</h1>

<label>Mês</label>
<input type="month" id="mes">

<label>Valor kWh</label>
<input type="number" id="kwh" step="0.01">

<button onclick="carregar()">Carregar mês</button>

<div id="lista"></div>

<script>
const UNIDADES = [
  "Pet Shop",
  "Loja de Conveniência",
  "Loja de Acessórios",
  "Cabeleireiro",
  "Loja de Celulares",
  "Loja de Chocolate",
  "Lavanderia",
  "Sanduicheria"
];

let dados = {};
let mesAtual = "";

function modelo() {
  return { aluguel:0, eIni:0, eFim:0, pagos:[] };
}

function carregar() {
  mesAtual = document.getElementById("mes").value;
  if (!mesAtual) { alert("Selecione o mês"); return; }

  const raw = localStorage.getItem("aluguels_"+mesAtual);
  dados = raw ? JSON.parse(raw) : {};

  UNIDADES.forEach(u => {
    if (!dados[u]) dados[u] = modelo();
  });

  salvar();
  render();
}

function salvar() {
  localStorage.setItem("aluguels_"+mesAtual, JSON.stringify(dados));
}

function pagar(un) {
  const v = parseFloat(document.getElementById("p_"+un).value||0);
  if (v<=0) return;
  dados[un].pagos.push(v);
  document.getElementById("p_"+un).value="";
  salvar();
  render();
}

function render() {
  const lista = document.getElementById("lista");
  lista.innerHTML="";

  const kwh = parseFloat(document.getElementById("kwh").value||0);

  UNIDADES.forEach(u => {
    const d = dados[u];
    const consumo = Math.max(d.eFim - d.eIni, 0);
    const energia = consumo * kwh;
    const total = Number(d.aluguel) + energia;
    const pago = d.pagos.reduce((a,b)=>a+b,0);
    const saldo = total - pago;

    const card = document.createElement("div");
    card.className = "card " + (saldo<=0 && total>0 ? "paid" : "unpaid");

    card.innerHTML = `
      <h3>${u}</h3>

      <label>Aluguel</label>
      <input type="number" value="${d.aluguel}" onchange="dados['${u}'].aluguel=this.value; salvar(); render();">

      <label>Energia inicial</label>
      <input type="number" value="${d.eIni}" onchange="dados['${u}'].eIni=this.value; salvar(); render();">

      <label>Energia final</label>
      <input type="number" value="${d.eFim}" onchange="dados['${u}'].eFim=this.value; salvar(); render();">

      <label>Pagamento</label>
      <input type="number" id="p_${u}">
      <button onclick="pagar('${u}')">Adicionar pagamento</button>

      <div class="status">
        Total: R$ ${total.toFixed(2)} |
        Pago: R$ ${pago.toFixed(2)} |
        Saldo: R$ ${saldo.toFixed(2)}
      </div>
    `;

    lista.appendChild(card);
  });
}

window.onload = () => {
  const hoje = new Date();
  document.getElementById("mes").value = hoje.toISOString().slice(0,7);
};
</script>

</body>
</html>
